#include <stdio.h>
#include "inv_kin.h"

static const char* TAG = "inv_kin";


static double x_func(double* angle)
{
    double x = DELTA2 * sin(angle[0]) - DELTA1 * sin(angle[0]) - DELTA3 * sin(angle[0]) + L0 * cos(angle[0]) * sin(angle[1]) + DELTA5 * cos(angle[4]) * sin(angle[0]) - L1 * cos(angle[0]) * cos(angle[1]) * sin(angle[2]) + L1 * cos(angle[0]) * cos(angle[2]) * sin(angle[1]) + DELTA4 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) + DELTA4 * cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) + DELTA4 * cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) + DELTA5 * cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[4]);

    return x;
}


static double y_func(double* angle)
{
    double y = DELTA1 * cos(angle[0]) - DELTA2 * cos(angle[0]) + DELTA3 * cos(angle[0]) - DELTA5 * cos(angle[0]) * cos(angle[4]) + L0 * sin(angle[0]) * sin(angle[1]) - L1 * cos(angle[1]) * sin(angle[0]) * sin(angle[2]) + L1 * cos(angle[2]) * sin(angle[0]) * sin(angle[1]) + DELTA4 * cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) - DELTA4 * cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) + DELTA4 * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) + DELTA4 * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) + DELTA5 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[4]) + DELTA5 * cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4]);

    return y;
}


static double z_func(double* angle)
{
    double z = DELTA0 + L0 * cos(angle[1]) + L1 * cos(angle[1]) * cos(angle[2]) + L1 * sin(angle[1]) * sin(angle[2]) + DELTA4 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) + DELTA4 * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) + DELTA4 * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) - DELTA5 * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) - DELTA5 * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) - DELTA5 * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]);

    return z;
}


static double phi_func(double* angle)
{
    double sin_phi = cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]);
    double cos_phi = cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) - cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) - sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]);

    double phi = atan2(sin_phi, cos_phi);

    return phi;
}


static double psi_func(double* angle)
{
    double sin_psi = -(cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]));
    double cos_psi = sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]));

    double psi = atan2(sin_psi, cos_psi);

    return psi;
}


static double theta_func(double* angle)
{
    double sin_theta = cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]);
    double cos_theta = cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]);

    double theta6 = atan2(sin_theta, cos_theta);

    return theta6;
}


// ================================================================================================


static double diff_x_phi0(double* angle)
{
    double diff_x_phi0 = DELTA2 * cos(angle[0]) - DELTA1 * cos(angle[0]) - DELTA3 * cos(angle[0]) + DELTA5 * cos(angle[0]) * cos(angle[4]) - L0 * sin(angle[0]) * sin(angle[1]) + L1 * cos(angle[1]) * sin(angle[0]) * sin(angle[2]) - L1 * cos(angle[2]) * sin(angle[0]) * sin(angle[1]) - DELTA4 * cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) + DELTA4 * cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) - DELTA4 * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) - DELTA4 * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - DELTA5 * cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4]) - DELTA5 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[4]);

    return diff_x_phi0;
}


static double diff_x_phi1(double* angle)
{
    double diff_x_phi1 = L0 * cos(angle[0]) * cos(angle[1]) + L1 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) + L1 * cos(angle[0]) * sin(angle[1]) * sin(angle[2]) + DELTA4 * cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) + DELTA4 * cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) + DELTA4 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) - DELTA5 * cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) - DELTA5 * cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]);

    return diff_x_phi1;
}


static double diff_x_phi2(double* angle)
{
    double diff_x_phi2 = DELTA4 * cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) - L1 * cos(angle[0]) * sin(angle[1]) * sin(angle[2]) - DELTA4 * cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) - L1 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) - DELTA4 * cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) - DELTA4 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) + DELTA5 * cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]);

    return diff_x_phi2;
}


static double diff_x_phi3(double* angle)
{
    double diff_x_phi3 = DELTA4 * cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) + DELTA4 * cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) + DELTA4 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) - DELTA5 * cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) - DELTA5 * cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]);

    return diff_x_phi3;
}


static double diff_x_phi4(double* angle)
{
    double diff_x_phi4 = DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) - DELTA5 * sin(angle[0]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * sin(angle[2]) * sin(angle[3]) - DELTA5 * cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * sin(angle[1]) * sin(angle[3]) + DELTA5 * cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[2]);

    return diff_x_phi4;
}


static double diff_x_phi5(double* angle)
{
    double diff_x_phi5 = 0.0f;

    return diff_x_phi5;
}


// ================================================================================================


static double diff_y_phi0(double* angle)
{
    double diff_y_phi0 = DELTA2 * sin(angle[0]) - DELTA1 * sin(angle[0]) - DELTA3 * sin(angle[0]) + DELTA5 * cos(angle[4]) * sin(angle[0]) + L0 * cos(angle[0]) * sin(angle[1]) - L1 * cos(angle[0]) * cos(angle[1]) * sin(angle[2]) + L1 * cos(angle[0]) * cos(angle[2]) * sin(angle[1]) + DELTA4 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) + DELTA4 * cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) + DELTA4 * cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) + DELTA5 * cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4]);

    return diff_y_phi0;
}


static double diff_y_phi1(double* angle)
{
    double diff_y_phi1 = L0 * cos(angle[1]) * sin(angle[0]) + L1 * cos(angle[1]) * cos(angle[2]) * sin(angle[0]) + L1 * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) + DELTA4 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) + DELTA4 * cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + DELTA4 * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) - DELTA5 * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[4]) - DELTA5 * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[4]);

    return diff_y_phi1;
}


static double diff_y_phi2(double* angle)
{
    double diff_y_phi2 = DELTA4 * cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) - L1 * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) - DELTA4 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) - DELTA4 * cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - L1 * cos(angle[1]) * cos(angle[2]) * sin(angle[0]) - DELTA4 * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) + DELTA5 * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[4]) + DELTA5 * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[4]);

    return diff_y_phi2;
}


static double diff_y_phi3(double* angle)
{
    double diff_y_phi3 = DELTA4 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) + DELTA4 * cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + DELTA4 * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) - DELTA5 * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[4]) - DELTA5 * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[4]);

    return diff_y_phi3;
}


static double diff_y_phi4(double* angle)
{
    double diff_y_phi4 = DELTA5 * cos(angle[0]) * sin(angle[4]) + DELTA5 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[0]) + DELTA5 * cos(angle[1]) * cos(angle[4]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - DELTA5 * cos(angle[2]) * cos(angle[4]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + DELTA5 * cos(angle[3]) * cos(angle[4]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]);

    return diff_y_phi4;
}


static double diff_y_phi5(double* angle)
{
    double diff_y_phi5 = 0.0f;

    return diff_y_phi5;
}


// ================================================================================================


static double diff_z_phi0(double* angle)
{
    double diff_z_phi0 = 0.0f;

    return diff_z_phi0;
}


static double diff_z_phi1(double* angle)
{
    double diff_z_phi1 = L1 * cos(angle[1]) * sin(angle[2]) - L0 * sin(angle[1]) - L1 * cos(angle[2]) * sin(angle[1]) - DELTA4 * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) + DELTA4 * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) - DELTA4 * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) - DELTA4 * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - DELTA5 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4]);

    return diff_z_phi1;
}


static double diff_z_phi2(double* angle)
{
    double diff_z_phi2 = L1 * cos(angle[2]) * sin(angle[1]) - L1 * cos(angle[1]) * sin(angle[2]) + DELTA4 * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) + DELTA4 * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) + DELTA4 * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) + DELTA5 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4]);

    return diff_z_phi2;
}


static double diff_z_phi3(double* angle)
{
    double diff_z_phi3 = DELTA4 * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) - DELTA4 * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) - DELTA4 * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) - DELTA4 * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - DELTA5 * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) + DELTA5 * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) - DELTA5 * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4]);

    return diff_z_phi3;
}


static double diff_z_phi4(double* angle)
{
    double diff_z_phi4 = DELTA5 * cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) - DELTA5 * cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) - DELTA5 * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) - DELTA5 * cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]);

    return diff_z_phi4;
}


static double diff_z_phi5(double* angle)
{
    double diff_z_phi5 = 0.0f;

    return diff_z_phi5;
}


// ================================================================================================


static double diff_phi_phi0(double* angle)
{
    double diff_phi_phi0 = 0.0f;

    return diff_phi_phi0;
}


static double diff_phi_phi1(double* angle)
{
    double diff_phi_phi1 = ((cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[3]) - cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[2]) + cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) + cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[5]) - cos(angle[1]) * cos(angle[4]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[2]) * cos(angle[4]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) - cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5])) / (cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])) + ((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[4]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4])) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]))) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f)) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5])), 2.0f) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f) + 1.0f);

    return diff_phi_phi1;
}


static double diff_phi_phi2(double* angle)
{
    double diff_phi_phi2 = -((cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[3]) - cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[2]) + cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) + cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[5]) - cos(angle[1]) * cos(angle[4]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[2]) * cos(angle[4]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) - cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5])) / (cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])) + ((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[4]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4])) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]))) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f)) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5])), 2.0f) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f) + 1.0f);

    return diff_phi_phi2;
}


static double diff_phi_phi3(double* angle)
{
    double diff_phi_phi3 = ((cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[3]) - cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[2]) + cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) + cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[5]) - cos(angle[1]) * cos(angle[4]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[2]) * cos(angle[4]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) - cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5])) / (cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])) + ((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[4]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4])) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]))) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f)) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5])), 2.0f) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f) + 1.0f);

    return diff_phi_phi3;
}


static double diff_phi_phi4(double* angle)
{
    double diff_phi_phi4 = ((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) * sin(angle[5]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) * sin(angle[5])) / (cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])) + ((cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]))) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f)) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5])), 2.0f) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f) + 1.0f);

    return diff_phi_phi4;
}


static double diff_phi_phi5(double* angle)
{
    double diff_phi_phi5 = (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) / ((pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5])), 2.0f) / pow((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])), 2.0f) + 1.0f ) * (cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[4]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])));

    return diff_phi_phi5;
}


// ================================================================================================


static double diff_psi_phi0(double* angle)
{
    double diff_psi_phi0 = ((((2.0f * pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 3.0f)) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 3.0f) + (2.0f * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]))) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]))) / (2.0f * pow((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f), 1.5f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]))) - ((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / (sqrt((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f)) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f))) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f) / ((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) + 1.0f);

    return diff_psi_phi0;
}


static double diff_psi_phi1(double* angle)
{
    double diff_psi_phi1 = ((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]))) + ((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[0]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]))) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) - (((2.0f * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[0]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f)) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 3.0f) - (2.0f * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[5]) + cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]))) / (2.0f * pow((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f), 1.5f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])))) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f) / ((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) + 1.0f);

    return diff_psi_phi1;
}


static double diff_psi_phi2(double* angle)
{
    double diff_psi_phi2 = -((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]))) + (cos(angle[0]) * pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f)) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) - (cos(angle[5]) * sin(angle[4]) * pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / (pow((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f), 1.5f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 4.0f))) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f) / ((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) + 1.0f);

    return diff_psi_phi2;
}


static double diff_psi_phi3(double* angle)
{
    double diff_psi_phi3 = ((cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]))) + (cos(angle[0]) * pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f)) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) - (cos(angle[5]) * sin(angle[4]) * pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / (pow((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f), 1.5f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 4.0f))) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f) / ((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) + 1);

    return diff_psi_phi3;
}


static double diff_psi_phi4(double* angle)
{
    double diff_psi_phi4 = -((cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[3]) * sin(angle[4]) - cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[2]) * sin(angle[4]) + cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[4]) + cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4])) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]))) + (((2.0f * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[4]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[2]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + cos(angle[3]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4])) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) - (2.0f * (cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[4]) + cos(angle[0]) * cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[0]) * cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + cos(angle[0]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4])) * pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f)) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 3.0f)) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]))) / (2.0f * pow((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f), 1.5f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]))) + ((cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[4]) + cos(angle[0]) * cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[0]) * cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + cos(angle[0]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4])) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]))) / (sqrt((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f)) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f))) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f) / ((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) + 1.0f);

    return diff_psi_phi4;
}


static double diff_psi_phi5(double* angle)
{
    double diff_psi_phi5 = -((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) + cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[5]) + cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5])) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]))) - ((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * (sin(angle[0]) * sin(angle[4]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[3]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[2]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) + cos(angle[0]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[5]) - cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) - cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]))) / (sqrt(pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) + (((2.0f * pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) * (sin(angle[0]) * sin(angle[4]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[3]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[2]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) + cos(angle[0]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[5]) - cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) - cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 3.0f) + (2.0f * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])) * (cos(angle[0]) * sin(angle[4]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[0]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) - cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[0]) * sin(angle[5]) + cos(angle[1]) * cos(angle[4]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * cos(angle[4]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * cos(angle[4]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) * (cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]))) / (2.0f * pow((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f), 1.5f) * (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])))) / (pow((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])), 2.0f) / ((pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f) * pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) + 1.0f);

    return diff_psi_phi5;
}


// ================================================================================================


static double diff_theta_phi0(double* angle)
{
    double diff_theta7_phi0 = 1.0f;

    return diff_theta7_phi0;
}


static double diff_theta_phi1(double* angle)
{
    double diff_theta_phi1 = ((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[5]) + cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) / (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])) - ((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[0]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) / (pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f);

    return diff_theta_phi1;
}


static double diff_theta_phi2(double* angle)
{
    double diff_theta_phi2 = -((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[5]) + cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) / (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])) - ((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[0]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) / (pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f);

    return diff_theta_phi2;
}


static double diff_theta_phi3(double* angle)
{
    double diff_theta_phi3 = ((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[5]) + cos(angle[1]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) - cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) / (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])) - ((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[0]) * cos(angle[2]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[3]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]) - cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[3]) + cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) - cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) - cos(angle[0]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3])) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) / (pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f);

    return diff_theta_phi3;
}


static double diff_theta_phi4(double* angle)
{
    double diff_theta_phi4 = -((cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[4]) * cos(angle[5]) + cos(angle[1]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[2]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + cos(angle[3]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4])) / (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])) - ((cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[4]) + cos(angle[0]) * cos(angle[1]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) * sin(angle[4]) - cos(angle[0]) * cos(angle[2]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) * sin(angle[4]) + cos(angle[0]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[4])) * (cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2)) / (pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f);

    return diff_theta_phi4;
}


static double diff_theta_phi5(double* angle)
{
    double diff_theta_phi5 = -((cos(angle[0]) * sin(angle[4]) * sin(angle[5]) - cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[0]) * sin(angle[3]) + cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) - cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) - cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[0]) * sin(angle[5]) + cos(angle[1]) * cos(angle[4]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[2]) * cos(angle[4]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) + cos(angle[3]) * cos(angle[4]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5])) / (cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])) + ((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])) * (sin(angle[0]) * sin(angle[4]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[5]) * sin(angle[3]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * cos(angle[5]) * sin(angle[2]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * cos(angle[5]) * sin(angle[1]) + cos(angle[0]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * sin(angle[5]) - cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * sin(angle[1]) * sin(angle[3]) * sin(angle[5]) - cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * sin(angle[1]) * sin(angle[2]) * sin(angle[5]))) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f)) / (pow((cos(angle[0]) * cos(angle[5]) * sin(angle[4]) + cos(angle[1]) * cos(angle[2]) * sin(angle[0]) * sin(angle[3]) * sin(angle[5]) - cos(angle[1]) * cos(angle[3]) * sin(angle[0]) * sin(angle[2]) * sin(angle[5]) + cos(angle[2]) * cos(angle[3]) * sin(angle[0]) * sin(angle[1]) * sin(angle[5]) + sin(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) + cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[2]) * sin(angle[3]) - cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[3]) + cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[0]) * sin(angle[1]) * sin(angle[2])), 2.0f) / pow((cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * sin(angle[3]) * sin(angle[5]) - cos(angle[5]) * sin(angle[0]) * sin(angle[4]) - cos(angle[0]) * cos(angle[1]) * cos(angle[3]) * sin(angle[2]) * sin(angle[5]) + cos(angle[0]) * cos(angle[2]) * cos(angle[3]) * sin(angle[1]) * sin(angle[5]) + cos(angle[0]) * sin(angle[1]) * sin(angle[2]) * sin(angle[3]) * sin(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[2]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) + cos(angle[0]) * cos(angle[1]) * cos(angle[4]) * cos(angle[5]) * sin(angle[2]) * sin(angle[3]) - cos(angle[0]) * cos(angle[2]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[3]) + cos(angle[0]) * cos(angle[3]) * cos(angle[4]) * cos(angle[5]) * sin(angle[1]) * sin(angle[2])), 2.0f) + 1.0f);

    return diff_theta_phi5;
}


// ================================================================================================


static double deg2rad(double deg)
{
    return deg / 180.0f * M_PI;
}


static double rad2deg(double rad)
{
    return rad * 180.0f / M_PI;
}


void calc_inv_kin(double* desired_pos, double* joint_pos)
{
    // change degrees to radians
    for (uint8_t i = 3; i < 6; i++)
        desired_pos[i] = deg2rad(desired_pos[i]);

    for (uint8_t i = 0; i < 6; i++)
        joint_pos[i] = deg2rad(joint_pos[i]);

    // current position errors in mm
    double x_err = desired_pos[0] - x_func(joint_pos);
    double y_err = desired_pos[1] - y_func(joint_pos);
    double z_err = desired_pos[2] - z_func(joint_pos);

    // current orientation errors in radians
    double phi_err = desired_pos[3] - phi_func(joint_pos);
    double psi_err = desired_pos[4] - psi_func(joint_pos);
    double theta_err = desired_pos[5] - theta_func(joint_pos);

    // current iterations
    uint32_t iter = 0;

    // create jacobian and pseudoinverse jacobian matrixes
    matrix_t J;
    matrix_alloc(&J, 6, 6);
    matrix_t Jt;
    matrix_alloc(&Jt, 6, 6);
    matrix_t JJt;
    matrix_alloc(&JJt, 6, 6);
    matrix_t JJt_inv;
    matrix_alloc(&JJt_inv, 6, 6);
    matrix_t J_psinv;
    matrix_alloc(&J_psinv, 6, 6);

    // main algorithm loop
    while (fabs(x_err) >= ACC_X_ERR || fabs(y_err) >= ACC_Y_ERR || fabs(z_err) >= ACC_Z_ERR ||
            fabs(phi_err) >= ACC_PHI_ERR || fabs(psi_err) >= ACC_PSI_ERR || fabs(theta_err) >= ACC_THETA_ERR)
    {
        // fill jacobian matrix
        J.array[0][0] = diff_x_phi0(joint_pos);
        J.array[0][1] = diff_x_phi1(joint_pos);
        J.array[0][2] = diff_x_phi2(joint_pos);
        J.array[0][3] = diff_x_phi3(joint_pos);
        J.array[0][4] = diff_x_phi4(joint_pos);
        J.array[0][5] = diff_x_phi5(joint_pos);

        J.array[1][0] = diff_y_phi0(joint_pos);
        J.array[1][1] = diff_y_phi1(joint_pos);
        J.array[1][2] = diff_y_phi2(joint_pos);
        J.array[1][3] = diff_y_phi3(joint_pos);
        J.array[1][4] = diff_y_phi4(joint_pos);
        J.array[1][5] = diff_y_phi5(joint_pos);

        J.array[2][0] = diff_z_phi0(joint_pos);
        J.array[2][1] = diff_z_phi1(joint_pos);
        J.array[2][2] = diff_z_phi2(joint_pos);
        J.array[2][3] = diff_z_phi3(joint_pos);
        J.array[2][4] = diff_z_phi4(joint_pos);
        J.array[2][5] = diff_z_phi5(joint_pos);

        J.array[3][0] = diff_phi_phi0(joint_pos);
        J.array[3][1] = diff_phi_phi1(joint_pos);
        J.array[3][2] = diff_phi_phi2(joint_pos);
        J.array[3][3] = diff_phi_phi3(joint_pos);
        J.array[3][4] = diff_phi_phi4(joint_pos);
        J.array[3][5] = diff_phi_phi5(joint_pos);

        J.array[4][0] = diff_psi_phi0(joint_pos);
        J.array[4][1] = diff_psi_phi1(joint_pos);
        J.array[4][2] = diff_psi_phi2(joint_pos);
        J.array[4][3] = diff_psi_phi3(joint_pos);
        J.array[4][4] = diff_psi_phi4(joint_pos);
        J.array[4][5] = diff_psi_phi5(joint_pos);

        J.array[5][0] = diff_theta_phi0(joint_pos);
        J.array[5][1] = diff_theta_phi1(joint_pos);
        J.array[5][2] = diff_theta_phi2(joint_pos);
        J.array[5][3] = diff_theta_phi3(joint_pos);
        J.array[5][4] = diff_theta_phi4(joint_pos);
        J.array[5][5] = diff_theta_phi5(joint_pos);

        // calculate pseudoinverse jacobian
        matrix_trans(&J, &Jt);
        matrix_mul(&J, &Jt, &JJt);
        matrix_inv(&JJt, &JJt_inv);
        matrix_mul(&Jt, &JJt_inv, &J_psinv);

        // check for NaN
        for (int i = 0; i < J_psinv.rows; i++)
        {
            for (int j = 0; j < J_psinv.cols; j++)
            {
                if (isnan(J_psinv.array[i][j]) == 1)
                {
                    ESP_LOGE(TAG, "NaN detected!");
                    abort();
                }
            }
        }

        // update angles
        for (uint8_t i = 0; i < 6; i++)
        {
            joint_pos[i] += J_psinv.array[i][0] * x_err + J_psinv.array[i][1] * y_err + J_psinv.array[i][2] * z_err +
                                J_psinv.array[i][3] * phi_err + J_psinv.array[i][4] * psi_err + J_psinv.array[i][5] * theta_err;
        }

        // update errors
        x_err = desired_pos[0] - x_func(joint_pos);
        y_err = desired_pos[1] - y_func(joint_pos);
        z_err = desired_pos[2] - z_func(joint_pos);
        phi_err = desired_pos[3] - phi_func(joint_pos);
        psi_err = desired_pos[4] - psi_func(joint_pos);
        theta_err = desired_pos[5] - theta_func(joint_pos);

        if (iter >= MAX_ITER)
        {
            ESP_LOGW(TAG, "max iterations reached!");
            break;
        }

        iter++;
    }

    // prepare results
    for (uint8_t i = 0; i < 6; i++)
    {
        while (joint_pos[i] > deg2rad(180.0f))
            joint_pos[i] -= deg2rad(360.0f);
        while (joint_pos[i] < deg2rad(-180.0f))
            joint_pos[i] += deg2rad(360.0f);
    }

    // debug
    printf("iters = %ld\n\n", iter);

    printf("x_err = %f\n", x_err);
    printf("y_err = %f\n", y_err);
    printf("z_err = %f\n", z_err);
    printf("phi_err = %f\n", rad2deg(phi_err));
    printf("psi_err = %f\n", rad2deg(psi_err));
    printf("theta_err = %f\n\n", rad2deg(theta_err));

    printf("joint_pos[0] = %f\n", rad2deg(joint_pos[0]));
    printf("joint_pos[1] = %f\n", rad2deg(joint_pos[1]));
    printf("joint_pos[2] = %f\n", rad2deg(joint_pos[2]));
    printf("joint_pos[3] = %f\n", rad2deg(joint_pos[3]));
    printf("joint_pos[4] = %f\n", rad2deg(joint_pos[4]));
    printf("joint_pos[5] = %f\n\n", rad2deg(joint_pos[5]));

    printf("desired_pos[0] = %f\tx = %f\n", desired_pos[0], x_func(joint_pos));
    printf("desired_pos[1] = %f\ty = %f\n", desired_pos[1], y_func(joint_pos));
    printf("desired_pos[2] = %f\tz = %f\n", desired_pos[2], z_func(joint_pos));
    printf("desired_pos[3] = %f\tphi = %f\n", rad2deg(desired_pos[3]), rad2deg(phi_func(joint_pos)));
    printf("desired_pos[4] = %f\tpsi = %f\n", rad2deg(desired_pos[4]), rad2deg(psi_func(joint_pos)));
    printf("desired_pos[5] = %f\ttheta = %f\n\n", rad2deg(desired_pos[5]), rad2deg(theta_func(joint_pos)));

    // deallocate memory
    matrix_dealloc(&J);
    matrix_dealloc(&Jt);
    matrix_dealloc(&JJt);
    matrix_dealloc(&JJt_inv);
    matrix_dealloc(&J_psinv);

    // change radians back to degrees
    for (uint8_t i = 3; i < 6; i++)
        desired_pos[i] = rad2deg(desired_pos[i]);

    for (uint8_t i = 0; i < 6; i++)
        joint_pos[i] = rad2deg(joint_pos[i]);
}